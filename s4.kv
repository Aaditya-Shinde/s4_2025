#:import Factory kivy.factory.Factory

WindowManager:
    Diagnosis:
    About:
    CameraScreen:
        
<About>:
    name: "About"
    color: 0, 0, 0, 1
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size 
    GridLayout:
        cols: 1
        rows: 2
        size: root.width, root.height

        ActionBar:
            background_color: (0.14, 0.68, 0.87, 1)
            background_image: ''

            ActionView:
                use_separator: True

                ActionPrevious:
                    title: 'DiagnoSys'
                    with_previous: False

                ActionButton:
                    text: "Home"
                    on_press: app.root.current = "Diagnosis"

                ActionButton:
                    text: "About"
                    on_press: app.root.current = "About"
        ScrollView:
            do_scroll_y: True
            bar_width: 8

            GridLayout:
                cols: 1
                size_hint_y: None
                padding: 24
                spacing: 20
                size_hint: 1, 1

                canvas.before:
                    Color:
                        rgba: 0.97, 0.97, 0.97, 1  # light gray bg
                    Rectangle:
                        pos: self.pos
                        size: self.size

                Label:
                    text: "[b]Heading[/b]"
                    markup: True
                    font_size: '26sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    halign: 'center'
                    text_size: self.width, None

                BoxLayout:
                    orientation: 'vertical'
                    padding: 16
                    spacing: 10
                    size_hint_y: None
                    height: self.minimum_height
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius: [16]

                    Label:
                        text: "üßÅ Put text here that explains something cool"
                        font_size: '16sp'
                        size_hint_y: None
                        height: self.texture_size[1]
                        halign: 'left'
                        valign: 'top'
                        text_size: self.width, None

                BoxLayout:
                    orientation: 'vertical'
                    padding: 16
                    spacing: 10
                    size_hint_y: None
                    height: self.minimum_height
                    canvas.before:
                        Color:
                            rgba: 1, 1, 1, 1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius: [16]

                    Label:
                        text: "üöÄ Put another section heading"
                        font_size: '18sp'
                        bold: True
                        size_hint_y: None
                        height: self.texture_size[1]
                        halign: 'left'
                        text_size: self.width, None

                    Label:
                        text: "Put more description here"
                        font_size: '15sp'
                        size_hint_y: None
                        height: self.texture_size[1]
                        halign: 'left'
                        text_size: self.width, None

                Label:
                    text: "üåç [i]Put footer or contact info here[/i]"
                    markup: True
                    font_size: '14sp'
                    size_hint_y: None
                    height: self.texture_size[1]
                    halign: 'center'
                    text_size: self.width, None

                Widget:
                    size_hint_y: None
                    height: 40


<HelpPopup@Popup>:
    auto_dismiss: False
    title: "Choose a hospital"
    size_hint: 0.6, 0.2
    pos_hint:{"x":0.2, "top":0.9}
    BoxLayout:
        orientation: 'vertical'
        Button:
            text: 'El Camino Health'
            on_release: root.dismiss()
            on_release: app.root.get_screen("Diagnosis").get_help("El Camino Health")
        Button:
            text: 'Valley Medical'
            on_release: root.dismiss()
            on_release: app.root.get_screen("Diagnosis").get_help("Valley Medical")

<Diagnosis>:
    name: "Diagnosis"
    color: 0, 0, 0, 1
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size 
    GridLayout:
        size: root.width, root.height
        cols: 1
        rows: 5
        ActionBar:
            background_color: (0.14, 0.68, 0.87, 1)
            background_image: ''

            ActionView:
                use_separator: True

                ActionPrevious:
                    title: 'DiagnoSys'
                    with_previous: False

                ActionButton:
                    text: "Home"
                    on_press: app.root.current = "Diagnosis"

                ActionButton:
                    text: "About"
                    on_press: app.root.current = "About"
        Label:
            text: 'Diagnosify'
            color: 0, 0, 0, 1
            size_hint_y: 0.1
        ScrollView:
            size_hint: 1, 0.9
            do_scroll_x: False
            do_scroll_y: True
            Label:
                id: response
                text: ""
                padding: 5, 0, 5, 0
                size_hint_y: None
                height: self.texture_size[1]
                text_size: self.width, None
                halign: 'left'
                valign: 'top'
                markup: True
                    
        BoxLayout:
            orientation: 'horizontal'
            padding: 5, 0, 5, 0
            size_hint_y: 0.15
            Button:
                background_normal: ''
                background_down: ''
                on_press: self.background_color = (0.7, 0.7, 0.7, 1)
                on_release: self.background_color = (0, 0, 0, 0)
                on_release: app.root.current = "Camera"
                size_hint: None, None
                Image:
                    source: "camera.png"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y
                    size: self.parent.size[0]-20, self.parent.size[1]
            Button:
                background_normal: ''
                background_down: ''
                on_press: self.background_color = (0.7, 0.7, 0.7, 1)
                on_release: self.background_color = (0, 0, 0, 0)
                on_release: app.root.current = "Camera"
                size_hint: None, None
                Image:
                    source: "call.png"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y
                    size: self.parent.size[0]-20, self.parent.size[1]
            Button:
                background_normal: ''
                background_down: ''
                on_press: self.background_color = (0.7, 0.7, 0.7, 1)
                on_release: self.background_color = (0, 0, 0, 0)
                on_release: Factory.HelpPopup().open()
                size_hint: None, None
                Image:
                    source: "doctor.png"
                    center_x: self.parent.center_x
                    center_y: self.parent.center_y
                    size: self.parent.size[0]-20, self.parent.size[1]
        TextInput:
            padding: 20
            size_hint: 1, 0.3
            id: prompt
            hint_text: "Type symptoms here"
            multiline: False
            focused: False
            on_text_validate: root.text_inquiry()

<CameraScreen>
    name: "Camera"
    Camera:
        id:camera
        play:True
        index: 0
        size_hint: 1, 1
        Button:
            on_press: app.root.current = "Diagnosis"
            on_press: root.save_image()
            text: 'Capture'
            center_x: self.parent.center_x
            size: 150, 150
